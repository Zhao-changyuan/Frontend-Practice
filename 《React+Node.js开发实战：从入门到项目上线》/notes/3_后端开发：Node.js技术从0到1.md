## 3.1 Node.js的特性

### 3.1.1 模块化规范

AMD CommonJS ES6

#### 1. AMD

Asynchronous Module Definition，异步模块定义。

所以依赖该模块的语句都定义在一个回调函数中，等加载完成之后，这个回调函数才会运行。

RequireJS是对这个异步加载模块方法的实现。

#### 2. CommonJS简介

CommonJS是JavaScript模块化的一种规范，该规范最初用在服务器端的Node开发中，现在前端Webpack打包工具也支持原生CommonJS。

#### ES 6模块系统简介

真正的标准规范

### 3.1.2 异步I/O和事件驱动

#### 1. 单线程

进程是资源分配的最小单位，而线程是程序执行的最小单位，简单来说，线程可以看做是一种特殊的进程，某个进程下的多个线程共享部分资源，如地址空间。

Node的单线程指的是主线程是“单线程”。

#### 2. 异步 I/O

阻塞I/0、非阻塞I/O及I/O多路复用都是同步I/O。异步I/O做I/O操作的时候不会造成任何阻塞。

#### 3. 事件驱动

事件驱动就是通过监听事件的状态变化来做出相应的操作。

对于事件驱动编程来说，如果某个事件的回调函数是计算密集型（CPU被占用）函数，那么这个回调函数将会阻塞所有回调函数的执行。

## 3.2 HTTP简介

### 3.2.1 请求与响应

### 3.2.2 RESTful架构风格

Representational State Transfer，表征性状态转移。

#### 1. 资源与动作

RESTful架构应该遵循统一接口原则。统一结构包含了一组受限的预定义操作，不论什么样的资源，都是通过使用相同的接口进行资源访问。

（1）资源：必须是名词且都是复数形式。

（2）动作：通过HTTP所定义的方法来表述对资源的动作。

GET: 读取（Read）

POST：新建（Create）

PUT：更新（Update）

PATCH：更新（Update）

DELETE：删除（Delete）

PUT是幂等的，PATCH是非幂等的。

#### 2. 响应状态码

客户端的每一次请求服务器都必须给出回应。服务器响应包括HTTP状态码和数据两部分。

#### 3. 响应数据

API返回的数据格式不推荐使用纯文本，而应该返回标准化的结构化数据。

### 3.2.3 JSON数据格式

JSON格式还广泛应用于NoSQL服务中。

Not Only SQL。

## 3.3 开始使用Node.js

## 3.4 Node.js的常用模块

模块系统，可维护性

### 3.4.1 全局变量

Node中的全局对象是global

#### 1. 保留字

两个常用的保留字分别是`__filename`和`__dirname`

（1）`__filename`表示当前正在执行的脚本的文件名。`__filename`输出文件所在位置的绝对路径，并且和命令行参数所指定的文件名不一定相同。

（2）`__dirname`表示当前执行的脚本所在的目录。

#### 2. 定时任务

setTimeout() setInterval() setImmediate()

#### 3. console控制台

#### 4. process进程

process进程代表当前Node进程状态的对象，并提供了一个与操作系统交互的简单接。

### 3.4.2 工具模块

#### 1. os模块

os模块提供了一些基本的系统操作函数，通过os模块，Node程序可以实现和操作系统的交互。

#### 2. path模块

path模块提供了用于处理文件路径和目录路径的实用工具。

#### 3. net模块

net模块提供了一些用于底层网络通信的小工具。

### 3.4.3 HTTP模块

对于一个HTTP请求，通常从以下4个方面进行解析和处理：

- 路由解析：根据URL及注册的路由，将请求分派到对应的业务逻辑中进行处理；
- 参数解析：提取请求的参数以理解处理此次请求的相关信息；
- 内容解析：提取POST等请求体的内容信息；
- 响应结果：将业务逻辑处理的结果返回给客户端。

#### 1. 路由解析

#### 2. 参数解析

对请求进行路由解析后，在处理请求之前还需要解析请求的参数。

#### 3.内容解析

#### 4.响应结果

### 3.4.4 事件循环和EventEmiter

#### 1. 事件循环

- setImmediate()在当前轮询（poll）阶段完成后执行；
- setTimeout()在毫秒最小与之经过后的下一次轮询定时器（timers）阶段执行。

也就是说，在一次事件循环周期内，setImmediate()早于setTimeout()执行。

#### 2. EventEmitter

events.EventEmitter的核心就是对事件触发与事件监听器功能的封装。

DevOps（Development和Operations的组合词）是软件开发人员（Dev）和运维技术人员（Ops）的统称。