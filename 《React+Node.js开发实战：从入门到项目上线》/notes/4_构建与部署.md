对于基于Node开发的后端应用来说，将其部署到生产服务器的流程如下：

1. 使用进程管理工具启动服务
2. 使用Nginx做反向代理，并配置CORS跨域。
3. 配置域名DNS解析。

## 4.1 Webpack简介

### 4.1.1 一切皆模块

高内聚复用性

### 4.1.2 Webpack的使用

#### 1. 输入、输出

#### 2. 预处理器

由于Webpack本身只能识别JavaScript代码，对于其他类型的资源必须预先定义一个或多个loader加载器对其进行转译，处处为Webpack能够处理的形式，因此loader实际上承担了预处理器的工作。

与loader相关的配置都配置在module中，其中module.rules表示模块的处理规则。

- use: 接收一个数组，包含该规则所使用的loader加载器，打包时按照**数组从后往前的顺序**将资源交给loader加载器进行处理。

#### 3. 代码分片

代码分片（Code Splitting）作为Webpack的一个重要特性，可以把代码按照特定的形式进行拆分，使应用不必一次全部加载，实现按需加载。

### 4.1.3 Webpack环境配置

#### 1. 开发环境

webpack-dev-server与Webpack打包时生成的dis目录无关。

自动刷新 Live-Reloading

模块热替换 HMR Hot Module Replacement

#### 2. 生产环境

每次打包资源时针对资源的内容计算出一个Hash值，然后将Hash作为版本识别添加到文件名中，这样每次代码发生变化时相应的hash值和文件名就会发生变化。

#### 3. 资源压缩

在资源发布上线之前，通常还需要针对资源进行压缩，以较小资源的体积。

### 4.1.4 Webpack 进阶

#### 1. 并行构建HappyPack

注意：HappyPack只是作用在loader加载器上，使用多个进程同时对文件进行编译。

#### 2. 动态链接库DllPlugin

是指将第三方及不常修改的模块预先编译和打包，然后在项目打包时直接使用提前打包的模块库即可。

#### 3. 打包分析

完成Webpack打包后，还需要对打包输出的结果进行检查和分析。

## 4.2 Nginx简介

### 4.2.1 Nginx的基本特性

#### 1. I/O多路复用

#### 2. 模块化

#### 3. 进程工作模式

### 4.2.3 Nginx的配置

Nginx配置文件主要分成一下4部分：

- main：全局设置，设置的指令将影响其他部分的设置；
- server：主机设置，主要用户指定虚拟主机域名、IP和端口；
- upstream：上游服务器设置，要为反向代理、负载均衡相关配置；
- location：位置设置，用于匹配网页位置，如更目录“/” "/images"等。

他们之间的关系如下：

- server继承main
- location 继承 server
- upstream既不会继承指令也不会被继承，它有自己的特殊指令。

#### 1. 静态资源

#### 2. 反向代理

#### 3. 负载均衡

### 4.2.4 Nginx的高级特性

#### 1. 缓存控制

#### 2. CORS跨域

CORS（Cross-Origin Resource Sharing，跨源资源共享）是跨域AJAX请求的根本解决办法。

#### 3. OpenResty

它把Lua解析器内嵌到Nginx中，从而可以使用Lua语言编程。

简单来说，OpenResty是基于Nginx的扩展，并且开发语言不再是Nginx的C语言实现，二是更加简单、易用的Lua语言。

## 4.3 PM2 简介

### 4.3.1 守护进程

### 4.3.2 进程管理工具对比

### 4.3.3 PM2的安装和使用

#### 1.基本用法

#### 2.日志访问

#### 3. 服务自启动

## 4.4 部署

### 4.4.1 React的部署

### 4.4.2 Node.js 的部署

