## 目标

- 能够知道移动web的开发现状
- 能够写出标准的viewport
- 能够使用移动web的调试方法
- 能够说出移动端常见的布局方案
- 能够描述流式布局
- 能够独立完成京东移动端首页

## 1. 移动端基础

### 1.1 浏览器现状

国内的UC和QQ，百度等手机浏览器都是根据Webkit修改过的内核，国内尚无自主研发的内核，就像国内的手机操作系统都是基于Android修改开发的一样。

总结：兼容移动端主流浏览器，处理Webkit内核浏览器即可。

### 1.2 手机屏幕现状

移动端设备屏幕尺寸非常多，碎片化严重。

作为开发者无需关注这些分辨率，因为我们常用的尺寸单位是px。

### 1.3 常见移动端屏幕尺寸

作为前端开发，不建议大家去纠结dp、dpi、pt、ppi等单位。

### 1.4 移动端调试方法

- Chrome devTools（谷歌浏览器）的模拟手机调试
- 搭建本地web服务器，手机和服务器一个局域网内，通过手机访问服务器
- 使用外网服务器，直接IP或域名访问

## 2. 视口

视口（viewport）就是浏览器显示页面内容的屏幕区域。视口可以分为布局视口、视觉视口和理想视口

### 2.1 布局视口 layout viewport

- 一般移动设备的浏览器都默认设置了一个布局视口，用于解决早期的PC端页面在手机上显示的问题。
- iOS、Android基本都将这个视口分辨率设置为980px，所以PC上的网页大多都能在手机上呈现，只不过元素看上去很小，一般默认可以通过手动缩放网页。

### 2.2 视觉视口 visual viewport

- 字面意思，它是用户正在看到的网站的区域。注意：是网站的区域。
- 我们可以通过缩放去操作视觉视口，但不会影响布局视口，布局视口仍保持原来的宽度。

### 2.3 理想视口 ideal viewport

- 为了使网站在移动端有最理想的浏览和阅读宽度而设定
- 理想视口，对设备来讲，是最理想的视口尺寸
- 需要手动添加meta视口标签通知浏览器操作
- meta视口标签的主要目的：布局视口的宽度应该与理想视口的宽度一致，简单理解就是设备有多宽，我们布局的视口就多宽。

### 2.4 总结

我们移动端布局想要的是理想视口就是手机屏幕有多宽，我们的布局视口就有多宽。

### 2.5 meta视口标签

```HTML
<!--标准写法-->
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
```

| 属性          | 解释说明                                               |
| ------------- | ------------------------------------------------------ |
| width         | 宽度设置的是viewport宽度，可以设置device-width的特殊值 |
| initial-scale | 初始缩放比，大于0的数字                                |
| maximum-scale | 最大缩放比，大与0的数字                                |
| minimum-scale | 最小缩放比，大与0的数字                                |
| user-scalable | 用户是否可以缩放，yes或no（1或0）                      |

### 2.6 标准的viewport设置

- 视口宽度和设备保持一致
- 视口的默认缩放比例1.0
- 不允许用户自行缩放
- 最大允许的缩放比例1.0
- 最小允许的缩放比例1.0

## 3. 二倍图

### 3.1 物理像素&物理像素比

- 物理像素点指的是屏幕显示的最小颗粒，是物理真实存在的。这是厂商在出厂时就设置好了。
- 我们开发时候的1px不是一定等于1个物理像素的。
- PC端页面，1px等于一个物理像素的，但是移动端就不尽相同
- 一个px能显示的物理像素点的个数，称为物理像素比或屏幕像素比



- PC端早前的手机屏幕 / 普通手机屏幕 1CSS像素 = 1物理像素的
- Retina （视网膜屏幕）是一种显示技术，可以将更多的物理像素点压缩致一块屏幕里，从而达到更高的分辨率，并提高屏幕显示的细腻程度。

### 3.2 多背图

- 对于一张50px * 50px的图片，在手机Retina屏幕中打开，按照刚才的物理像素比会放大倍数，这样会造成图片模糊
- 在标准的viewport设置中，使用倍图来提高图片质量，解决在高清设置中的模糊问题
- 通常使用二倍图，因为iPhone\6\7\8的影响，但是现在还存在3倍图4倍图的情况，这个看实际开发公司需求
- 背景图片，注意缩放问题。

### 3.3 背景缩放 background-size

background-size属性规定背景图像的尺寸

只写一个参数，肯定是宽度，高度省略了，会等比例缩放。

可以设置百分比数值，相对于背景图片所在元素宽高来进行计算。

- 单位：长度|百分比|cover|contain；
- cover把背景图像扩展至足够大，以使背景图像完全覆盖背景区域，可能有部分背景图片显示不全。
- contain把图像扩展至最大尺寸，以使其宽度或高度完全适应内容区域，可能会有部分空白区域。

cover和contain都是按原始比例拉伸。

### 3.4 多背图切图 cutterman

- @3X 3倍图
- @2X 2倍图
- @1X 1倍原图

## 4. 移动端开发选择

### 4.1 移动端主流方案

1. 单独制作移动端页面（主流）
2. 响应式页面兼容移动端（其次）

### 4.2 单独移动端页面（主流）

通常情况下，网址域名前面加m（mobile）可以打开移动端。通过判断设置，如果是移动设备打开，则跳到移动端页面。

### 4.3 响应式兼容PC移动端

通过判断屏幕宽度来改变样式，以适应不同终端。

缺点：制作麻烦，需要花很大精力去调兼容性问题。

### 4.4 总结

现在市场主流的选择还是单独制作移动端页面。

## 5. 移动端技术解决方案

### 5.1 移动端浏览器

我们就考虑Webkit兼容性问题。

我们可以放心使用H5标签和CSS3样式。

### 5.2 CSS初始化 normalize.css

- 保护了有价值的默认值
- 修复了浏览器的bug
- 是模块化的
- 拥有详细的文档

### 5.3 CSS3 盒子模型 box-sizing

- 传统模式宽度计算：盒子的宽度 = CSS中设置的width + padding + border，box-sizing: content-box;
- CSS盒子模型：盒子的宽度 = CSS中设置的宽度width里面包含了border和padding，也就是说，我们的CSS3中的盒子模型，padding和border不会撑大盒子了。box-sizing: border-box;

**传统 or CSS3盒子模型？**

- 移动端可以全部CSS3盒子模型
- PC端如果完全需要兼容性，我们就用传统模式，如果不考虑兼容性，我们就选择CSS3盒子模型。

### 5.4 特殊样式

```CSS
/* CSS3盒子模型 */
box-sizing: border-box;
-webkit-box-sizing: border-box;
/* 点击高亮我们需要清除 设置为transparent 完全透明 */
-webkit-tap-highlight-color: transparent;
/* 在移动端浏览器默认的外观在iOS上加上这个属性才能给按钮和输入框自定义样式 */
-webkit-appearence: none;
/* 禁用长按页面时的弹出菜单 */
img, a { -webkit-touch-callout: none; }
```

## 6. 移动端常见布局

1. **单独制作移动端页面（主流）**
   1. 流式布局（百分比布局）
   2. flex弹性布局（强烈推荐）
   3. less+rem+媒体查询布局
   4. 混合布局
2. **响应式页面兼容移动端（其次）**
   1. 媒体查询
   2. bootstrap

### 6.1 流式布局（百分比布局）

- 流式布局，也就是百分比布局，也称为非固定像素布局
- 通过盒子的宽度设置成百分比来根据屏幕的宽度来进行伸缩，不受固定像素的限制，内容项两侧填充。
- 流式布局方式是移动web开发使用的比较常见的布局方式。
- max-width: 最大宽度
- min-width: 最小宽度

#### 京东移动端首页

方案：我们采取单独制作移动页面方案

技术：布局采取流式布局

#### 5. 二倍精灵图做法

- 在firework里面把精灵图比例缩放为原来的一半
- 之后根据大小测量坐标
- 注意代码里面background-size也要写：精灵图原来宽度的一半。

#### 6. 图片格式

DPG图片压缩技术，京东自主研发退出DPG图片压缩技术。

webp图片格式，谷歌开啊的一种旨在加快图片加载速度的图片格式。

