在一个程序可以运行之前，它首先需要被翻译成一种能够被计算机执行的形式。

完成这项翻译工作的软件系统成为编译器（compiler）。

## 1.1 语言处理器
简单地说，一个编译器就是一个程序，它可以阅读以某一种语言（源语言）编写的程序，并把该程序翻译成为一个等价的、用另一种语言（目标语言）编写的程序。编译器的重要任务之一是报告它在翻译过程中发现的源程序中的错误。

解释器（interpreter）是另一种常见的语言处理器。它并不通过翻译的方式生成目标程序。从用户的角度看，解释器直接利用用户提供的输入执行源程序中指定的操作。

在把用户输入映射称为输出的过程中，由一个编译器产生的机器语言目标程序通常比一个解释器块很多。然而，解释器的错误诊断效果通常比编译器更好，因为它逐个语句地执行源程序。

除了编译器之外，创建一个可执行的目标程序还需要一些其他程序。一个源程序可能被分割成多个模块，并存放于独立的文件中。把源程序聚合在一起的任务有时会由一个被称为预处理器（preprocessor）的程序独立完成。预处理器还负责把拿些称为宏的缩写形式转换成源语言的语句。

然后，将经过预处理的源程序作为输入传递给一个编译器。编译器可能产生一个汇编语言程序作为其输出，因为汇编语言比较容易输出和调试。接着，这个汇编语言程序由称为汇编器（assembler）的程序进行处理，并生成可重定位的机器代码。

大型程序经常被分成多个部分进行编译，因此，可重定位的机器代码有必要和其他可重定位的目标文件以及库文件连接到一起，形成真正在机器上运行的代码。一个文件中代码可能指向另一个文件中的位置，而链接器（linker）能够解决外部内存地址的问题。最后，加载器（loader）把所有的可执行目标文件放到内存中执行。

## 1.2 一个编译器的结构
编译器能够把源程序映射为在语义上等价的目标程序。这个映射由两个部分组成：分析部份和综合部份：

分析（analysis）部分把源程序分界成为多个组成要素，并在这些要素之上加上语法结构。然后它使用这个结构来创建该源程序的一个中间表示。如果分析部份检查出源程序没有按照正确的语法构成，或者语义上不一致，他就必须提供有用的信息，使得用户可以按此进行改正。分析部份还会收集有关源程序的信息，并把信息存放在一个称为符号表（symbol table）的数据结构中。符号表将和中间表示形式一起传送给综合部份。

综合（synthesis）部分根据中间表示和符号表中的信息来构造用户期待的目标程序。

### 1.2.1 词法分析
编译器的第一个步骤称为词法分析（lexical analysis）或扫描（scanning）。词法分析器读入组成源程序的字符流，并且将它们组织称为有意义的词素（lexeme）的序列。对于每个词素，词法分析器产生如下形式的词法单元（token）作为输出：

<token-name, attribute-value>

这个词法单元被传送给下一个步骤，即语法分析。在这个词法单元中，第一个分量token-name是一个由语法分析步骤使用的抽象符号，而第二个分量attribute-value指向符号表中关于词法单元的条目。符号表条目的信息会被语义分析和代码生成步骤使用。

### 1.2.2 语法分析器
语法分析器使用由词法分析器生成的各个词法单元的第一个分量来创建树形的中间表示。该中间表示给出了词法分析产生的词法单元流的语法结构。一个常用的表示方法是语法树（syntax tree），树中的每个内部结点表示一个运算，而该结点的子节点表示该运算的分量。

### 1.2.3 语义分析
语义分析器（semantic analyzer）使用语法树和符号表中的信息来检查源程序是否合语言定义的语义一致。它同时也收集类型信息，并把这些信息存放在语法树或符号表中，以便在随后的中间代码生成过程中使用。

语义分析的一个重要部分是类型检查（type checking）。

### 1.2.4 中间代码生成
在源程序的语法分析和语义分析完成之后，很多编译器生成一个明确的低级的或类及其语言的中间表示。我们可以把这个表示看做是某个抽象机器的程序。该中间表示应该具有两个重要的性质：它应该易于生成，且能够被轻松第翻译为目标机器上的语言。

### 1.2.5 代码优化

### 1.2.6 代码生成
代码生成器以源程序的中间表示形式作为输入，并把它映射到目标语言。
代码生成的一个至关重要的方面是合理分配寄存器以存放变量的值。

运行时刻的存储组织方法依赖于被编译的语言。编译器在中间代码生成或代码生成阶段做出有关存储分配的决定。

### 1.2.7 符号表管理
编译器的重要功能之一就是记录源程序中使用的变量的名称，并收集和每个名字的各种属性有关的信息，这些属性可以提供一个名字的存储分配、它的类型、作用域（即在程序中的哪些地方可以使用这个名字的值）等信息。对于过程名字，这些信息还包括：它的参数数量和类型、每个参数的传递方法（比如传值或传引用）以及返回类型。

符号表数据结构为每个变量名字创建了一个记录条目。记录的字段就是名字的各个属性。这个数据结构应该允许编译器迅速查找到每个名字的记录，并向记录中快速存放和获取记录中的数据。

### 1.2.8 将多个步骤组合成趟

### 1.2.9 编译器构造工具
一些常用的编译器构造工具包括：
1. 语法分析器的生成器：可以根据一个程序设计语言的语法描述自动生成语法分析器。
2. 扫描器的生成器：可以根据一个语言的语法单元的正则表达式生成词法分析器。
3. 语法制导的翻译引擎：可以生成一组用于遍历分析树并生成中间代码的例程。
4. 代码生成器的生成器
5. 数据流分析引擎
6. 编译器构造工具集

## 1.3 程序设计语言的发展历程

### 1.3.1 走向高级程序设计语言
另一种语言分类方式把程序中指明如何完成一个计算任务的语言的称为强制式语言，而把程序中指明要进行哪些计算的语言称为声明式语言。

脚本语言是具有高层次运算符的解释型语言，它通常被用于把多个计算过程“粘合”在一起。这些计算过程被称为脚本。使用脚本语言编写的程序通常要比用其他语言写的等价的程序短很多。

### 1.3.2 对编译器的影响
实际上，计算机系统的性能是非常依赖于编译技术的，以至于在构建一个计算机之前，编译器会被用作评价一个体系结构概念的工具。

为一个源程序生成最佳目标代码的问题一般来说是不可判定的。

## 1.4 构建一个编译器的相关科学
编译器的设计中有很多通过数学方法抽象出问题本质从而解决现实世界中复杂问题的完美例子。

### 1.4.1 编译器设计和实现中的建模

对编译器的研究主要是有关如何设计正确的数学模型和选择正确算法的研究。

### 1.4.2 代码优化的科学
如果想是的编译器产生经过良好优化的代码，图、矩阵和线性规划之类的模型是必不可少的。

在编译器设计中，最重要的技能之一是明确描述出真正要解决的问题的能力。

设置一个编译器时最重要的目标是使它正确。

第二个目标是编译器应该有效提高很多输入程序的性能。

我们在研究编译器时不仅要学习如何构造一个编译器，还要学习解决复杂和开放性问题的一般方法学。

## 1.5 编译技术的应用

### 1.5.1 高级程序设计语言的实现
优化编译器包括了提高所生成代码性能的技术，因此弥补了因高层次抽象而引入的低效率。

寄存器分配的最优选择很大程度上取决于一个机器的体系结构的特点。

### 1.5.2 针对计算机体系结构的优化

### 1.5.3 计算机体系结构的设计
因为使用高级程序设计语言是一种规范，决定一个计算机系统性能开发的不是它的原始速度，还包括编译器能够以何种程度利用其特性。

### 1.5.4 程序翻译

### 1.5.5 软件生产率工具
优化器必须是保守的，在任何情况下都不能改变程序的语义。


## 1.6 程序设计语言基础

### 1.6.1 静态和动态的区别
如果一个语言使用的策略支持在编译器静态决定某个问题，那么我们说这个语言使用了一个静态（static）策略，或者说这个问题可以在编译时刻（compile time）决定。另一方面，一个只允许在运行程序的时候做出决定的策略被称为动态策略（dynamic policy），或者被认为需要在运行时刻（run time）做出决定。

如果仅通过阅读程序就可以确定一个声明的作用域，那么这个语言使用的是静态作用域（static scope），或者说词法作用域（lexical scope）。否则这个语言使用的是动态作用域(dynamic scope)。

### 1.6.2 环境与状态
1. 环境是一个从名字到存储位置的映射。因为变量就是指内存位置，我们还可以换一种方法，把环境定义为从名字到变量的映射。
2. 状态是一个从内存位置到它们的值的映射。

环境的改变需要遵守语言的作用域规则。

### 1.6.3 静态作用域和块结构

### 1.6.4 显示访问控制

### 1.6.5 动态作用域

术语动态作用域通常指的是下面的策略：对一个名字x的使用指向的是最近被调用但还没有被终止且声明了x的工程中的这个声明。

### 1.6.6 参数传递机制

### 1.6.7 别名






